2024-03-30 01:32:59,417 Driver       INFO     Spark session started....<pyspark.sql.session.SparkSession object at 0x7fdf681ea7f0>
2024-03-30 01:32:59,417 Driver       INFO     validating spark object
2024-03-30 01:32:59,417 Validate     INFO     Started the get_current_date function....
2024-03-30 01:33:04,218 Validate     WARNING  Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 30))] 
2024-03-30 01:33:04,218 Validate     INFO     Validation done, going forward ..
2024-03-30 01:33:04,218 Driver       INFO     Reading file which is of file format, parquet
2024-03-30 01:33:04,218 ingest       WARNING  load_files function started
2024-03-30 01:33:04,880 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-30 01:33:04,880 Driver       INFO     displaying Dataframe..
2024-03-30 01:33:07,518 Driver       INFO     Validating number of cities...
2024-03-30 01:33:07,518 ingest       WARNING  here to count the records in the df_city
2024-03-30 01:33:08,279 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-30 01:33:08,279 ingest       WARNING  load_files function started
2024-03-30 01:33:13,250 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-30 01:33:13,251 Driver       INFO     displaying Dataframe df_fact
2024-03-30 01:33:13,824 Driver       INFO     Validating number of records in fact...
2024-03-30 01:33:13,824 ingest       WARNING  here to count the records in the df_fact
2024-03-30 01:33:14,633 ingest       WARNING  Number of records present in the df_fact are 1329329
2024-03-30 01:33:14,633 Driver       INFO     implementing data processing functions..
2024-03-30 01:33:14,633 DataProcessing WARNING  data cleaning function started...
2024-03-30 01:33:14,633 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-30 01:33:14,683 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-30 01:33:14,708 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-30 01:33:14,723 DataProcessing WARNING  converting years_of_exp to int and replacing = 
2024-03-30 01:33:14,774 DataProcessing WARNING  concat firstname and lastname..
2024-03-30 01:33:14,800 DataProcessing WARNING  dropping columns presc_fname and presc_lname..
2024-03-30 01:33:14,809 DataProcessing WARNING  dropping null values for the columns ..
2024-03-30 01:33:14,833 DataProcessing WARNING  successfully dropped null values ..
2024-03-30 01:33:14,833 DataProcessing WARNING  replacing the null values of tx_cnt column with avg value..
2024-03-30 01:33:17,446 DataProcessing WARNING  data_clean() function executed, going forward..
2024-03-30 01:33:17,993 Driver       INFO     printing schema for dataframes...
2024-03-30 01:33:17,994 Validate     INFO     Started print_schema function for df_city_sel 
2024-03-30 01:33:17,998 Validate     INFO     	StructField('city', StringType(), True)
2024-03-30 01:33:17,998 Validate     INFO     	StructField('state_id', StringType(), True)
2024-03-30 01:33:17,999 Validate     INFO     	StructField('state_name', StringType(), True)
2024-03-30 01:33:17,999 Validate     INFO     	StructField('county_name', StringType(), True)
2024-03-30 01:33:17,999 Validate     INFO     	StructField('population', IntegerType(), True)
2024-03-30 01:33:17,999 Validate     INFO     	StructField('zips', StringType(), True)
2024-03-30 01:33:17,999 Validate     INFO     print_schema done, going forward ..
2024-03-30 01:33:17,999 Validate     INFO     Started print_schema function for df_presc_sel 
2024-03-30 01:33:18,000 Validate     INFO     	StructField('presc_id', IntegerType(), True)
2024-03-30 01:33:18,000 Validate     INFO     	StructField('presc_city', StringType(), True)
2024-03-30 01:33:18,000 Validate     INFO     	StructField('presc_state', StringType(), True)
2024-03-30 01:33:18,000 Validate     INFO     	StructField('presc_description', StringType(), True)
2024-03-30 01:33:18,000 Validate     INFO     	StructField('drug_name', StringType(), True)
2024-03-30 01:33:18,000 Validate     INFO     	StructField('tx_cnt', IntegerType(), True)
2024-03-30 01:33:18,000 Validate     INFO     	StructField('total_day_supply', IntegerType(), True)
2024-03-30 01:33:18,000 Validate     INFO     	StructField('total_drug_cost', DoubleType(), True)
2024-03-30 01:33:18,000 Validate     INFO     	StructField('years_of_exp', IntegerType(), True)
2024-03-30 01:33:18,000 Validate     INFO     	StructField('country_name', StringType(), False)
2024-03-30 01:33:18,000 Validate     INFO     	StructField('presc_fullname', StringType(), False)
2024-03-30 01:33:18,000 Validate     INFO     print_schema done, going forward ..
2024-03-30 01:33:18,000 Validate     WARNING  checking null values in all columns ..
2024-03-30 01:33:18,269 Validate     INFO     check_for_nulls done, going forward ..
2024-03-30 01:34:59,658 Driver       INFO     data_transformation executing...
2024-03-30 01:34:59,659 DataTransformation WARNING  processing data in data_report1 function...
2024-03-30 01:34:59,661 DataTransformation WARNING  calculating total number of zipcodes in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-03-30 01:34:59,707 DataTransformation WARNING  calculating distinct prescribers and total tx_cnt
2024-03-30 01:34:59,748 DataTransformation WARNING  do not create a report for city if no prescriber are present for that city so lets join df_city and df_presc
2024-03-30 01:34:59,800 DataTransformation WARNING  data_report1 function successfully executed, going forward..
2024-03-30 01:34:59,800 Driver       INFO     displaying the data_report1...
2024-03-30 01:35:06,853 DataTransformation WARNING  processing data in data_report2 function...
2024-03-30 01:35:06,871 DataTransformation WARNING  filter prescribers with age between 20 and 50 and filtering top 5 prescriber from each state
2024-03-30 01:35:06,976 DataTransformation WARNING  data_report2 function successfully executed, going forward..
2024-03-30 01:35:06,976 Driver       INFO     displaying the data_report2...
2024-03-30 01:35:13,329 Driver       INFO     writing data to output folders for dataframes df_report1 and df_report2 
2024-03-30 01:35:13,329 Extraction   WARNING  Extract_file function started...
2024-03-30 01:35:19,414 Extraction   WARNING  extract_file function successfully executed, going forward..
2024-03-30 01:35:19,414 Extraction   WARNING  Extract_file function started...
2024-03-30 01:35:25,610 Extraction   WARNING  extract_file function successfully executed, going forward..
2024-03-30 01:35:25,611 Driver       INFO     extracting files to output completed.. 
2024-03-30 01:35:25,611 Driver       INFO     total amount of time taken by job 156.364765875 seconds
2024-03-30 01:35:25,611 Driver       INFO     Application done
