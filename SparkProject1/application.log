2024-03-29 10:41:51,030 Driver       INFO     Spark session started....<pyspark.sql.session.SparkSession object at 0x7fc6d81e8cc0>
2024-03-29 10:41:51,030 Driver       INFO     validating spark object
2024-03-29 10:41:51,030 Validate     INFO     Started the get_current_date function....
2024-03-29 10:41:55,912 Validate     INFO     Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 29))] 
2024-03-29 10:41:55,912 Validate     INFO     Validation done, going forward ..
2024-03-29 10:41:55,912 Driver       INFO     Reading file which is of file format, parquet
2024-03-29 10:41:55,912 ingest       WARNING  load_files function started
2024-03-29 10:41:56,619 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-29 10:41:56,619 Driver       INFO     displaying Dataframe..
2024-03-29 10:41:59,286 Driver       INFO     Validating number of cities...
2024-03-29 10:41:59,286 ingest       WARNING  here to count the records in the df_city
2024-03-29 10:42:00,135 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-29 10:42:00,136 ingest       WARNING  load_files function started
2024-03-29 10:42:04,426 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-29 10:42:04,426 Driver       INFO     displaying Dataframe df_fact
2024-03-29 10:42:04,998 Driver       INFO     Validating number of records in fact...
2024-03-29 10:42:04,999 ingest       WARNING  here to count the records in the df_fact
2024-03-29 10:42:05,967 ingest       WARNING  Number of records present in the df_fact are 1329328
2024-03-29 10:42:05,967 Driver       INFO     implementing data processing functions..
2024-03-29 10:42:05,967 DataProcessing WARNING  data cleaning function started...
2024-03-29 10:42:05,967 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 10:42:06,028 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 10:42:06,054 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-29 10:42:06,070 DataProcessing WARNING  data_clean() function executed, going forward..
2024-03-29 10:42:06,649 Driver       INFO     printing schema for dataframes...
2024-03-29 10:42:06,649 Validate     INFO     Started print_schema function for df_city_sel 
2024-03-29 10:42:06,650 Validate     INFO     	StructField('city', StringType(), True)
2024-03-29 10:42:06,650 Validate     INFO     	StructField('state_id', StringType(), True)
2024-03-29 10:42:06,650 Validate     INFO     	StructField('state_name', StringType(), True)
2024-03-29 10:42:06,650 Validate     INFO     	StructField('county_name', StringType(), True)
2024-03-29 10:42:06,650 Validate     INFO     	StructField('population', IntegerType(), True)
2024-03-29 10:42:06,650 Validate     INFO     	StructField('zips', StringType(), True)
2024-03-29 10:42:06,650 Validate     INFO     print_schema done, going forward ..
2024-03-29 10:42:06,650 Validate     INFO     Started print_schema function for df_presc_sel 
2024-03-29 10:42:06,651 Validate     INFO     	StructField('presc_id', IntegerType(), True)
2024-03-29 10:42:06,651 Validate     INFO     	StructField('presc_lname', StringType(), True)
2024-03-29 10:42:06,651 Validate     INFO     	StructField('presc_fname', StringType(), True)
2024-03-29 10:42:06,651 Validate     INFO     	StructField('presc_city', StringType(), True)
2024-03-29 10:42:06,651 Validate     INFO     	StructField('presc_state', StringType(), True)
2024-03-29 10:42:06,652 Validate     INFO     	StructField('presc_description', StringType(), True)
2024-03-29 10:42:06,652 Validate     INFO     	StructField('drug_name', StringType(), True)
2024-03-29 10:42:06,652 Validate     INFO     	StructField('tx_cnt', IntegerType(), True)
2024-03-29 10:42:06,652 Validate     INFO     	StructField('total_day_supply', IntegerType(), True)
2024-03-29 10:42:06,652 Validate     INFO     	StructField('total_drug_cost', DoubleType(), True)
2024-03-29 10:42:06,652 Validate     INFO     	StructField('years_of_exp', StringType(), True)
2024-03-29 10:42:06,652 Validate     INFO     	StructField('country_name', StringType(), False)
2024-03-29 10:42:06,652 Validate     INFO     print_schema done, going forward ..
2024-03-29 10:42:06,652 Driver       INFO     Application done
2024-03-29 11:54:18,145 Driver       WARNING  Spark session started....<pyspark.sql.session.SparkSession object at 0x7fd54063ccf8>
2024-03-29 11:54:18,146 Driver       WARNING  validating spark object
2024-03-29 11:54:18,146 Validate     INFO     Started the get_current_date function....
2024-03-29 11:54:23,840 Validate     WARNING  Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 29))] 
2024-03-29 11:54:23,841 Validate     INFO     Validation done, going forward ..
2024-03-29 11:54:23,841 Driver       WARNING  Reading file which is of file format, parquet
2024-03-29 11:54:23,841 ingest       WARNING  load_files function started
2024-03-29 11:54:24,469 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-29 11:54:24,469 Driver       WARNING  displaying Dataframe..
2024-03-29 11:54:27,245 Driver       WARNING  Validating number of cities...
2024-03-29 11:54:27,245 ingest       WARNING  here to count the records in the df_city
2024-03-29 11:54:28,038 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-29 11:54:28,038 ingest       WARNING  load_files function started
2024-03-29 11:54:32,867 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-29 11:54:32,868 Driver       WARNING  displaying Dataframe df_fact
2024-03-29 11:54:33,692 Driver       WARNING  Validating number of records in fact...
2024-03-29 11:54:33,692 ingest       WARNING  here to count the records in the df_fact
2024-03-29 11:54:34,687 ingest       WARNING  Number of records present in the df_fact are 1329328
2024-03-29 11:54:34,687 Driver       WARNING  implementing data processing functions..
2024-03-29 11:54:34,687 DataProcessing WARNING  data cleaning function started...
2024-03-29 11:54:34,687 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 11:54:34,743 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 11:54:34,768 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-29 11:54:34,785 DataProcessing WARNING  converting years_of_exp to int and replacing = 
2024-03-29 11:54:34,841 DataProcessing WARNING  concat firstname and lastname..
2024-03-29 11:54:34,866 DataProcessing WARNING  dropping columns presc_fname and presc_lname..
2024-03-29 11:54:34,875 DataProcessing WARNING  data_clean() function executed, going forward..
2024-03-29 11:54:35,444 Driver       WARNING  printing schema for dataframes...
2024-03-29 11:54:35,444 Validate     INFO     Started print_schema function for df_city_sel 
2024-03-29 11:54:35,447 Validate     INFO     	StructField('city', StringType(), True)
2024-03-29 11:54:35,447 Validate     INFO     	StructField('state_id', StringType(), True)
2024-03-29 11:54:35,447 Validate     INFO     	StructField('state_name', StringType(), True)
2024-03-29 11:54:35,447 Validate     INFO     	StructField('county_name', StringType(), True)
2024-03-29 11:54:35,447 Validate     INFO     	StructField('population', IntegerType(), True)
2024-03-29 11:54:35,447 Validate     INFO     	StructField('zips', StringType(), True)
2024-03-29 11:54:35,447 Validate     INFO     print_schema done, going forward ..
2024-03-29 11:54:35,447 Validate     INFO     Started print_schema function for df_presc_sel 
2024-03-29 11:54:35,448 Validate     INFO     	StructField('presc_id', IntegerType(), True)
2024-03-29 11:54:35,448 Validate     INFO     	StructField('presc_city', StringType(), True)
2024-03-29 11:54:35,448 Validate     INFO     	StructField('presc_state', StringType(), True)
2024-03-29 11:54:35,448 Validate     INFO     	StructField('presc_description', StringType(), True)
2024-03-29 11:54:35,448 Validate     INFO     	StructField('drug_name', StringType(), True)
2024-03-29 11:54:35,448 Validate     INFO     	StructField('tx_cnt', IntegerType(), True)
2024-03-29 11:54:35,448 Validate     INFO     	StructField('total_day_supply', IntegerType(), True)
2024-03-29 11:54:35,448 Validate     INFO     	StructField('total_drug_cost', DoubleType(), True)
2024-03-29 11:54:35,448 Validate     INFO     	StructField('years_of_exp', IntegerType(), True)
2024-03-29 11:54:35,448 Validate     INFO     	StructField('country_name', StringType(), False)
2024-03-29 11:54:35,448 Validate     INFO     	StructField('fullName', StringType(), False)
2024-03-29 11:54:35,448 Validate     INFO     print_schema done, going forward ..
2024-03-29 11:54:35,448 Driver       WARNING  Application done
2024-03-29 11:55:11,505 Driver       WARNING  Spark session started....<pyspark.sql.session.SparkSession object at 0x7f91c845fc88>
2024-03-29 11:55:11,506 Driver       WARNING  validating spark object
2024-03-29 11:55:11,506 Validate     INFO     Started the get_current_date function....
2024-03-29 11:55:15,662 Validate     WARNING  Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 29))] 
2024-03-29 11:55:15,662 Validate     INFO     Validation done, going forward ..
2024-03-29 11:55:15,663 Driver       WARNING  Reading file which is of file format, parquet
2024-03-29 11:55:15,663 ingest       WARNING  load_files function started
2024-03-29 11:55:16,316 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-29 11:55:16,316 Driver       WARNING  displaying Dataframe..
2024-03-29 11:55:19,001 Driver       WARNING  Validating number of cities...
2024-03-29 11:55:19,001 ingest       WARNING  here to count the records in the df_city
2024-03-29 11:55:19,765 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-29 11:55:19,766 ingest       WARNING  load_files function started
2024-03-29 11:55:24,271 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-29 11:55:24,271 Driver       WARNING  displaying Dataframe df_fact
2024-03-29 11:55:24,822 Driver       WARNING  Validating number of records in fact...
2024-03-29 11:55:24,823 ingest       WARNING  here to count the records in the df_fact
2024-03-29 11:55:25,797 ingest       WARNING  Number of records present in the df_fact are 1329328
2024-03-29 11:55:25,798 Driver       WARNING  implementing data processing functions..
2024-03-29 11:55:25,798 DataProcessing WARNING  data cleaning function started...
2024-03-29 11:55:25,798 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 11:55:25,855 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 11:55:25,888 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-29 11:55:25,904 DataProcessing WARNING  converting years_of_exp to int and replacing = 
2024-03-29 11:55:26,002 DataProcessing WARNING  concat firstname and lastname..
2024-03-29 11:55:26,032 DataProcessing WARNING  dropping columns presc_fname and presc_lname..
2024-03-29 11:55:26,042 DataProcessing WARNING  data_clean() function executed, going forward..
2024-03-29 11:55:26,761 Driver       WARNING  printing schema for dataframes...
2024-03-29 11:55:26,761 Validate     INFO     Started print_schema function for df_city_sel 
2024-03-29 11:55:26,764 Validate     INFO     	StructField('city', StringType(), True)
2024-03-29 11:55:26,764 Validate     INFO     	StructField('state_id', StringType(), True)
2024-03-29 11:55:26,764 Validate     INFO     	StructField('state_name', StringType(), True)
2024-03-29 11:55:26,764 Validate     INFO     	StructField('county_name', StringType(), True)
2024-03-29 11:55:26,764 Validate     INFO     	StructField('population', IntegerType(), True)
2024-03-29 11:55:26,764 Validate     INFO     	StructField('zips', StringType(), True)
2024-03-29 11:55:26,764 Validate     INFO     print_schema done, going forward ..
2024-03-29 11:55:26,764 Validate     INFO     Started print_schema function for df_presc_sel 
2024-03-29 11:55:26,765 Validate     INFO     	StructField('presc_id', IntegerType(), True)
2024-03-29 11:55:26,765 Validate     INFO     	StructField('presc_city', StringType(), True)
2024-03-29 11:55:26,765 Validate     INFO     	StructField('presc_state', StringType(), True)
2024-03-29 11:55:26,765 Validate     INFO     	StructField('presc_description', StringType(), True)
2024-03-29 11:55:26,765 Validate     INFO     	StructField('drug_name', StringType(), True)
2024-03-29 11:55:26,765 Validate     INFO     	StructField('tx_cnt', IntegerType(), True)
2024-03-29 11:55:26,765 Validate     INFO     	StructField('total_day_supply', IntegerType(), True)
2024-03-29 11:55:26,765 Validate     INFO     	StructField('total_drug_cost', DoubleType(), True)
2024-03-29 11:55:26,765 Validate     INFO     	StructField('years_of_exp', IntegerType(), True)
2024-03-29 11:55:26,765 Validate     INFO     	StructField('country_name', StringType(), False)
2024-03-29 11:55:26,765 Validate     INFO     	StructField('fullName', StringType(), False)
2024-03-29 11:55:26,765 Validate     INFO     print_schema done, going forward ..
2024-03-29 11:55:26,765 Driver       WARNING  Application done
2024-03-29 12:05:55,686 Driver       WARNING  Spark session started....<pyspark.sql.session.SparkSession object at 0x7fea80187c18>
2024-03-29 12:05:55,688 Driver       WARNING  validating spark object
2024-03-29 12:05:55,688 Validate     INFO     Started the get_current_date function....
2024-03-29 12:06:00,623 Validate     WARNING  Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 29))] 
2024-03-29 12:06:00,623 Validate     INFO     Validation done, going forward ..
2024-03-29 12:06:00,623 Driver       WARNING  Reading file which is of file format, parquet
2024-03-29 12:06:00,623 ingest       WARNING  load_files function started
2024-03-29 12:06:01,315 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-29 12:06:01,315 Driver       WARNING  displaying Dataframe..
2024-03-29 12:06:04,078 Driver       WARNING  Validating number of cities...
2024-03-29 12:06:04,078 ingest       WARNING  here to count the records in the df_city
2024-03-29 12:06:04,776 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-29 12:06:04,777 ingest       WARNING  load_files function started
2024-03-29 12:06:09,487 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-29 12:06:09,490 Driver       WARNING  displaying Dataframe df_fact
2024-03-29 12:06:10,064 Driver       WARNING  Validating number of records in fact...
2024-03-29 12:06:10,064 ingest       WARNING  here to count the records in the df_fact
2024-03-29 12:06:10,988 ingest       WARNING  Number of records present in the df_fact are 1329328
2024-03-29 12:06:10,989 Driver       WARNING  implementing data processing functions..
2024-03-29 12:06:10,989 DataProcessing WARNING  data cleaning function started...
2024-03-29 12:06:10,989 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 12:06:11,048 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 12:06:11,076 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-29 12:06:11,092 DataProcessing WARNING  converting years_of_exp to int and replacing = 
2024-03-29 12:06:11,156 DataProcessing WARNING  concat firstname and lastname..
2024-03-29 12:06:11,182 DataProcessing WARNING  dropping columns presc_fname and presc_lname..
2024-03-29 12:06:11,195 DataProcessing WARNING  checking null values in all columns ..
2024-03-29 12:06:11,196 DataProcessing ERROR    An error occurred while calling data_clean() function, trace error...<function exp at 0x7feaa01f8d08>
Traceback (most recent call last):
  File "/Users/paresh.jadhav/PycharmProjects/SparkProject/data_processing.py", line 47, in data_clean
    df_presc_sel = df_presc_sel.select([count(when (isnan(c) | col(c).isNull(),c).alias('any_name') for c in df_presc_sel.columns)])
  File "/Users/paresh.jadhav/Projects/SparkProject/lib/python3.7/site-packages/pyspark/sql/utils.py", line 160, in wrapped
    return f(*args, **kwargs)
  File "/Users/paresh.jadhav/Projects/SparkProject/lib/python3.7/site-packages/pyspark/sql/functions.py", line 598, in count
    return _invoke_function_over_columns("count", col)
  File "/Users/paresh.jadhav/Projects/SparkProject/lib/python3.7/site-packages/pyspark/sql/functions.py", line 103, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
  File "/Users/paresh.jadhav/Projects/SparkProject/lib/python3.7/site-packages/pyspark/sql/functions.py", line 103, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
  File "/Users/paresh.jadhav/Projects/SparkProject/lib/python3.7/site-packages/pyspark/sql/column.py", line 69, in _to_java_column
    "function.".format(col, type(col))
TypeError: Invalid argument, not a string or column: <generator object data_clean.<locals>.<genexpr> at 0x7fea8017a138> of type <class 'generator'>. For column literals, use 'lit', 'array', 'struct' or 'create_map' function.
2024-03-29 12:06:11,200 Driver       ERROR    An error occurred when calling main() please check trace..Invalid argument, not a string or column: <generator object data_clean.<locals>.<genexpr> at 0x7fea8017a138> of type <class 'generator'>. For column literals, use 'lit', 'array', 'struct' or 'create_map' function.
Traceback (most recent call last):
  File "/Users/paresh.jadhav/PycharmProjects/SparkProject/driver.py", line 65, in main
    df_city_sel, df_presc_sel = data_clean(df_city, df_fact)
  File "/Users/paresh.jadhav/PycharmProjects/SparkProject/data_processing.py", line 47, in data_clean
    df_presc_sel = df_presc_sel.select([count(when (isnan(c) | col(c).isNull(),c).alias('any_name') for c in df_presc_sel.columns)])
  File "/Users/paresh.jadhav/Projects/SparkProject/lib/python3.7/site-packages/pyspark/sql/utils.py", line 160, in wrapped
    return f(*args, **kwargs)
  File "/Users/paresh.jadhav/Projects/SparkProject/lib/python3.7/site-packages/pyspark/sql/functions.py", line 598, in count
    return _invoke_function_over_columns("count", col)
  File "/Users/paresh.jadhav/Projects/SparkProject/lib/python3.7/site-packages/pyspark/sql/functions.py", line 103, in _invoke_function_over_columns
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
  File "/Users/paresh.jadhav/Projects/SparkProject/lib/python3.7/site-packages/pyspark/sql/functions.py", line 103, in <genexpr>
    return _invoke_function(name, *(_to_java_column(col) for col in cols))
  File "/Users/paresh.jadhav/Projects/SparkProject/lib/python3.7/site-packages/pyspark/sql/column.py", line 69, in _to_java_column
    "function.".format(col, type(col))
TypeError: Invalid argument, not a string or column: <generator object data_clean.<locals>.<genexpr> at 0x7fea8017a138> of type <class 'generator'>. For column literals, use 'lit', 'array', 'struct' or 'create_map' function.
2024-03-29 12:08:30,674 Driver       WARNING  Spark session started....<pyspark.sql.session.SparkSession object at 0x7fb6d8747320>
2024-03-29 12:08:30,674 Driver       WARNING  validating spark object
2024-03-29 12:08:30,674 Validate     INFO     Started the get_current_date function....
2024-03-29 12:08:37,136 Validate     WARNING  Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 29))] 
2024-03-29 12:08:37,136 Validate     INFO     Validation done, going forward ..
2024-03-29 12:08:37,137 Driver       WARNING  Reading file which is of file format, parquet
2024-03-29 12:08:37,137 ingest       WARNING  load_files function started
2024-03-29 12:08:37,836 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-29 12:08:37,836 Driver       WARNING  displaying Dataframe..
2024-03-29 12:08:40,488 Driver       WARNING  Validating number of cities...
2024-03-29 12:08:40,488 ingest       WARNING  here to count the records in the df_city
2024-03-29 12:08:41,248 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-29 12:08:41,249 ingest       WARNING  load_files function started
2024-03-29 12:08:45,925 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-29 12:08:45,926 Driver       WARNING  displaying Dataframe df_fact
2024-03-29 12:08:46,518 Driver       WARNING  Validating number of records in fact...
2024-03-29 12:08:46,518 ingest       WARNING  here to count the records in the df_fact
2024-03-29 12:08:47,541 ingest       WARNING  Number of records present in the df_fact are 1329328
2024-03-29 12:08:47,541 Driver       WARNING  implementing data processing functions..
2024-03-29 12:08:47,541 DataProcessing WARNING  data cleaning function started...
2024-03-29 12:08:47,541 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 12:08:47,598 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 12:08:47,624 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-29 12:08:47,645 DataProcessing WARNING  converting years_of_exp to int and replacing = 
2024-03-29 12:08:47,724 DataProcessing WARNING  concat firstname and lastname..
2024-03-29 12:08:47,747 DataProcessing WARNING  dropping columns presc_fname and presc_lname..
2024-03-29 12:08:47,760 DataProcessing WARNING  checking null values in all columns ..
2024-03-29 12:08:47,904 DataProcessing WARNING  data_clean() function executed, going forward..
2024-03-29 12:09:20,432 Driver       WARNING  printing schema for dataframes...
2024-03-29 12:09:20,433 Validate     INFO     Started print_schema function for df_city_sel 
2024-03-29 12:09:20,442 Validate     INFO     	StructField('city', StringType(), True)
2024-03-29 12:09:20,442 Validate     INFO     	StructField('state_id', StringType(), True)
2024-03-29 12:09:20,442 Validate     INFO     	StructField('state_name', StringType(), True)
2024-03-29 12:09:20,442 Validate     INFO     	StructField('county_name', StringType(), True)
2024-03-29 12:09:20,442 Validate     INFO     	StructField('population', IntegerType(), True)
2024-03-29 12:09:20,442 Validate     INFO     	StructField('zips', StringType(), True)
2024-03-29 12:09:20,442 Validate     INFO     print_schema done, going forward ..
2024-03-29 12:09:20,442 Validate     INFO     Started print_schema function for df_presc_sel 
2024-03-29 12:09:20,443 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,443 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,443 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,443 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,443 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,444 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,444 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,444 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,444 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,444 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,444 Validate     INFO     	StructField('any_name', LongType(), False)
2024-03-29 12:09:20,444 Validate     INFO     print_schema done, going forward ..
2024-03-29 12:09:20,444 Driver       WARNING  Application done
2024-03-29 12:19:03,539 Driver       WARNING  Spark session started....<pyspark.sql.session.SparkSession object at 0x7fd0d86fcd30>
2024-03-29 12:19:03,540 Driver       WARNING  validating spark object
2024-03-29 12:19:03,540 Validate     INFO     Started the get_current_date function....
2024-03-29 12:19:08,600 Validate     WARNING  Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 29))] 
2024-03-29 12:19:08,600 Validate     INFO     Validation done, going forward ..
2024-03-29 12:19:08,600 Driver       WARNING  Reading file which is of file format, parquet
2024-03-29 12:19:08,600 ingest       WARNING  load_files function started
2024-03-29 12:19:09,307 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-29 12:19:09,307 Driver       WARNING  displaying Dataframe..
2024-03-29 12:19:12,014 Driver       WARNING  Validating number of cities...
2024-03-29 12:19:12,014 ingest       WARNING  here to count the records in the df_city
2024-03-29 12:19:12,773 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-29 12:19:12,773 ingest       WARNING  load_files function started
2024-03-29 12:19:18,025 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-29 12:19:18,025 Driver       WARNING  displaying Dataframe df_fact
2024-03-29 12:19:18,626 Driver       WARNING  Validating number of records in fact...
2024-03-29 12:19:18,626 ingest       WARNING  here to count the records in the df_fact
2024-03-29 12:19:19,640 ingest       WARNING  Number of records present in the df_fact are 1329328
2024-03-29 12:19:19,640 Driver       WARNING  implementing data processing functions..
2024-03-29 12:19:19,640 DataProcessing WARNING  data cleaning function started...
2024-03-29 12:19:19,640 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 12:19:19,693 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 12:19:19,718 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-29 12:19:19,735 DataProcessing WARNING  converting years_of_exp to int and replacing = 
2024-03-29 12:19:19,803 DataProcessing WARNING  concat firstname and lastname..
2024-03-29 12:19:19,830 DataProcessing WARNING  dropping columns presc_fname and presc_lname..
2024-03-29 12:19:19,843 DataProcessing WARNING  checking null values in all columns ..
2024-03-29 12:19:19,986 DataProcessing WARNING  dropping null values for the columns ..
2024-03-29 12:19:20,043 DataProcessing WARNING  successfully dropped null values ..
2024-03-29 12:19:20,043 DataProcessing WARNING  data_clean() function executed, going forward..
2024-03-29 12:21:21,613 Driver       WARNING  printing schema for dataframes...
2024-03-29 12:21:21,616 Validate     INFO     Started print_schema function for df_city_sel 
2024-03-29 12:21:21,620 Validate     INFO     	StructField('city', StringType(), True)
2024-03-29 12:21:21,620 Validate     INFO     	StructField('state_id', StringType(), True)
2024-03-29 12:21:21,620 Validate     INFO     	StructField('state_name', StringType(), True)
2024-03-29 12:21:21,620 Validate     INFO     	StructField('county_name', StringType(), True)
2024-03-29 12:21:21,620 Validate     INFO     	StructField('population', IntegerType(), True)
2024-03-29 12:21:21,620 Validate     INFO     	StructField('zips', StringType(), True)
2024-03-29 12:21:21,620 Validate     INFO     print_schema done, going forward ..
2024-03-29 12:21:21,620 Validate     INFO     Started print_schema function for df_presc_sel 
2024-03-29 12:21:21,621 Validate     INFO     	StructField('presc_id', LongType(), False)
2024-03-29 12:21:21,621 Validate     INFO     	StructField('presc_city', LongType(), False)
2024-03-29 12:21:21,621 Validate     INFO     	StructField('presc_state', LongType(), False)
2024-03-29 12:21:21,621 Validate     INFO     	StructField('presc_description', LongType(), False)
2024-03-29 12:21:21,621 Validate     INFO     	StructField('drug_name', LongType(), False)
2024-03-29 12:21:21,621 Validate     INFO     	StructField('tx_cnt', LongType(), False)
2024-03-29 12:21:21,621 Validate     INFO     	StructField('total_day_supply', LongType(), False)
2024-03-29 12:21:21,621 Validate     INFO     	StructField('total_drug_cost', LongType(), False)
2024-03-29 12:21:21,621 Validate     INFO     	StructField('years_of_exp', LongType(), False)
2024-03-29 12:21:21,621 Validate     INFO     	StructField('country_name', LongType(), False)
2024-03-29 12:21:21,622 Validate     INFO     	StructField('fullName', LongType(), False)
2024-03-29 12:21:21,622 Validate     INFO     print_schema done, going forward ..
2024-03-29 12:21:21,622 Driver       WARNING  Application done
2024-03-29 12:23:24,420 Driver       WARNING  Spark session started....<pyspark.sql.session.SparkSession object at 0x7fb7602c0390>
2024-03-29 12:23:24,421 Driver       WARNING  validating spark object
2024-03-29 12:23:24,421 Validate     INFO     Started the get_current_date function....
2024-03-29 12:23:29,460 Validate     WARNING  Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 29))] 
2024-03-29 12:23:29,460 Validate     INFO     Validation done, going forward ..
2024-03-29 12:23:29,461 Driver       WARNING  Reading file which is of file format, parquet
2024-03-29 12:23:29,461 ingest       WARNING  load_files function started
2024-03-29 12:23:30,096 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-29 12:23:30,096 Driver       WARNING  displaying Dataframe..
2024-03-29 12:23:35,483 Driver       WARNING  Validating number of cities...
2024-03-29 12:23:35,484 ingest       WARNING  here to count the records in the df_city
2024-03-29 12:23:36,347 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-29 12:23:36,348 ingest       WARNING  load_files function started
2024-03-29 12:23:40,907 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-29 12:23:40,907 Driver       WARNING  displaying Dataframe df_fact
2024-03-29 12:23:41,430 Driver       WARNING  Validating number of records in fact...
2024-03-29 12:23:41,430 ingest       WARNING  here to count the records in the df_fact
2024-03-29 12:23:42,381 ingest       WARNING  Number of records present in the df_fact are 1329328
2024-03-29 12:23:42,381 Driver       WARNING  implementing data processing functions..
2024-03-29 12:23:42,381 DataProcessing WARNING  data cleaning function started...
2024-03-29 12:23:42,381 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 12:23:42,445 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 12:23:42,473 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-29 12:23:42,492 DataProcessing WARNING  converting years_of_exp to int and replacing = 
2024-03-29 12:23:42,554 DataProcessing WARNING  concat firstname and lastname..
2024-03-29 12:23:42,577 DataProcessing WARNING  dropping columns presc_fname and presc_lname..
2024-03-29 12:23:42,590 DataProcessing WARNING  checking null values in all columns ..
2024-03-29 12:23:42,758 DataProcessing WARNING  dropping null values for the columns ..
2024-03-29 12:23:42,810 DataProcessing WARNING  successfully dropped null values ..
2024-03-29 12:23:42,810 DataProcessing WARNING  data_clean() function executed, going forward..
2024-03-29 12:26:26,515 Driver       WARNING  printing schema for dataframes...
2024-03-29 12:26:26,516 Validate     INFO     Started print_schema function for df_city_sel 
2024-03-29 12:26:26,526 Validate     INFO     	StructField('city', StringType(), True)
2024-03-29 12:26:26,527 Validate     INFO     	StructField('state_id', StringType(), True)
2024-03-29 12:26:26,527 Validate     INFO     	StructField('state_name', StringType(), True)
2024-03-29 12:26:26,527 Validate     INFO     	StructField('county_name', StringType(), True)
2024-03-29 12:26:26,527 Validate     INFO     	StructField('population', IntegerType(), True)
2024-03-29 12:26:26,527 Validate     INFO     	StructField('zips', StringType(), True)
2024-03-29 12:26:26,527 Validate     INFO     print_schema done, going forward ..
2024-03-29 12:26:26,527 Validate     INFO     Started print_schema function for df_presc_sel 
2024-03-29 12:26:26,528 Validate     INFO     	StructField('presc_id', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     	StructField('presc_city', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     	StructField('presc_state', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     	StructField('presc_description', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     	StructField('drug_name', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     	StructField('tx_cnt', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     	StructField('total_day_supply', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     	StructField('total_drug_cost', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     	StructField('years_of_exp', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     	StructField('country_name', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     	StructField('fullName', LongType(), False)
2024-03-29 12:26:26,528 Validate     INFO     print_schema done, going forward ..
2024-03-29 12:26:26,528 Driver       WARNING  Application done
2024-03-29 12:29:01,422 Driver       WARNING  Spark session started....<pyspark.sql.session.SparkSession object at 0x7fef205eccf8>
2024-03-29 12:29:01,423 Driver       WARNING  validating spark object
2024-03-29 12:29:01,423 Validate     INFO     Started the get_current_date function....
2024-03-29 12:29:05,353 Validate     WARNING  Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 29))] 
2024-03-29 12:29:05,353 Validate     INFO     Validation done, going forward ..
2024-03-29 12:29:05,353 Driver       WARNING  Reading file which is of file format, parquet
2024-03-29 12:29:05,353 ingest       WARNING  load_files function started
2024-03-29 12:29:06,049 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-29 12:29:06,050 Driver       WARNING  displaying Dataframe..
2024-03-29 12:29:08,930 Driver       WARNING  Validating number of cities...
2024-03-29 12:29:08,931 ingest       WARNING  here to count the records in the df_city
2024-03-29 12:29:09,769 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-29 12:29:09,770 ingest       WARNING  load_files function started
2024-03-29 12:29:14,190 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-29 12:29:14,190 Driver       WARNING  displaying Dataframe df_fact
2024-03-29 12:29:14,814 Driver       WARNING  Validating number of records in fact...
2024-03-29 12:29:14,814 ingest       WARNING  here to count the records in the df_fact
2024-03-29 12:29:16,088 ingest       WARNING  Number of records present in the df_fact are 1329328
2024-03-29 12:29:16,088 Driver       WARNING  implementing data processing functions..
2024-03-29 12:29:16,088 DataProcessing WARNING  data cleaning function started...
2024-03-29 12:29:16,088 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 12:29:16,148 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 12:29:16,174 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-29 12:29:16,192 DataProcessing WARNING  converting years_of_exp to int and replacing = 
2024-03-29 12:29:16,254 DataProcessing WARNING  concat firstname and lastname..
2024-03-29 12:29:16,280 DataProcessing WARNING  dropping columns presc_fname and presc_lname..
2024-03-29 12:29:16,292 DataProcessing WARNING  checking null values in all columns ..
2024-03-29 12:29:16,434 DataProcessing WARNING  dropping null values for the columns ..
2024-03-29 12:29:16,474 DataProcessing WARNING  successfully dropped null values ..
2024-03-29 12:29:16,605 DataProcessing WARNING  data_clean() function executed, going forward..
2024-03-29 12:31:45,851 Driver       WARNING  printing schema for dataframes...
2024-03-29 12:31:45,852 Validate     INFO     Started print_schema function for df_city_sel 
2024-03-29 12:31:45,855 Validate     INFO     	StructField('city', StringType(), True)
2024-03-29 12:31:45,856 Validate     INFO     	StructField('state_id', StringType(), True)
2024-03-29 12:31:45,856 Validate     INFO     	StructField('state_name', StringType(), True)
2024-03-29 12:31:45,856 Validate     INFO     	StructField('county_name', StringType(), True)
2024-03-29 12:31:45,856 Validate     INFO     	StructField('population', IntegerType(), True)
2024-03-29 12:31:45,856 Validate     INFO     	StructField('zips', StringType(), True)
2024-03-29 12:31:45,856 Validate     INFO     print_schema done, going forward ..
2024-03-29 12:31:45,856 Validate     INFO     Started print_schema function for df_presc_sel 
2024-03-29 12:31:45,856 Validate     INFO     	StructField('presc_id', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     	StructField('presc_city', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     	StructField('presc_state', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     	StructField('presc_description', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     	StructField('drug_name', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     	StructField('tx_cnt', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     	StructField('total_day_supply', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     	StructField('total_drug_cost', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     	StructField('years_of_exp', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     	StructField('country_name', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     	StructField('fullName', LongType(), False)
2024-03-29 12:31:45,857 Validate     INFO     print_schema done, going forward ..
2024-03-29 12:31:45,857 Driver       WARNING  Application done
2024-03-29 15:08:25,438 Driver       INFO     Spark session started....<pyspark.sql.session.SparkSession object at 0x7fca68249198>
2024-03-29 15:08:25,439 Driver       INFO     validating spark object
2024-03-29 15:08:25,439 Validate     INFO     Started the get_current_date function....
2024-03-29 15:08:30,247 Validate     WARNING  Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 29))] 
2024-03-29 15:08:30,247 Validate     INFO     Validation done, going forward ..
2024-03-29 15:08:30,247 Driver       INFO     Reading file which is of file format, parquet
2024-03-29 15:08:30,247 ingest       WARNING  load_files function started
2024-03-29 15:08:30,946 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-29 15:08:30,946 Driver       INFO     displaying Dataframe..
2024-03-29 15:08:33,775 Driver       INFO     Validating number of cities...
2024-03-29 15:08:33,775 ingest       WARNING  here to count the records in the df_city
2024-03-29 15:08:34,644 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-29 15:08:34,645 ingest       WARNING  load_files function started
2024-03-29 15:08:39,123 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-29 15:08:39,124 Driver       INFO     displaying Dataframe df_fact
2024-03-29 15:08:39,675 Driver       INFO     Validating number of records in fact...
2024-03-29 15:08:39,676 ingest       WARNING  here to count the records in the df_fact
2024-03-29 15:08:40,700 ingest       WARNING  Number of records present in the df_fact are 1329328
2024-03-29 15:08:40,700 Driver       INFO     implementing data processing functions..
2024-03-29 15:08:40,700 DataProcessing WARNING  data cleaning function started...
2024-03-29 15:08:40,700 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 15:08:40,760 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 15:08:40,786 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-29 15:08:40,803 DataProcessing WARNING  converting years_of_exp to int and replacing = 
2024-03-29 15:08:40,869 DataProcessing WARNING  concat firstname and lastname..
2024-03-29 15:08:40,894 DataProcessing WARNING  dropping columns presc_fname and presc_lname..
2024-03-29 15:08:40,908 DataProcessing WARNING  dropping null values for the columns ..
2024-03-29 15:08:40,933 DataProcessing WARNING  successfully dropped null values ..
2024-03-29 15:08:40,934 DataProcessing WARNING  replacing the null values of tx_cnt column with avg value..
2024-03-29 15:08:43,489 DataProcessing WARNING  data_clean() function executed, going forward..
2024-03-29 15:08:44,019 Driver       INFO     printing schema for dataframes...
2024-03-29 15:08:44,019 Validate     INFO     Started print_schema function for df_city_sel 
2024-03-29 15:08:44,025 Validate     INFO     	StructField('city', StringType(), True)
2024-03-29 15:08:44,025 Validate     INFO     	StructField('state_id', StringType(), True)
2024-03-29 15:08:44,025 Validate     INFO     	StructField('state_name', StringType(), True)
2024-03-29 15:08:44,025 Validate     INFO     	StructField('county_name', StringType(), True)
2024-03-29 15:08:44,025 Validate     INFO     	StructField('population', IntegerType(), True)
2024-03-29 15:08:44,025 Validate     INFO     	StructField('zips', StringType(), True)
2024-03-29 15:08:44,025 Validate     INFO     print_schema done, going forward ..
2024-03-29 15:08:44,025 Validate     INFO     Started print_schema function for df_presc_sel 
2024-03-29 15:08:44,026 Validate     INFO     	StructField('presc_id', IntegerType(), True)
2024-03-29 15:08:44,026 Validate     INFO     	StructField('presc_city', StringType(), True)
2024-03-29 15:08:44,026 Validate     INFO     	StructField('presc_state', StringType(), True)
2024-03-29 15:08:44,026 Validate     INFO     	StructField('presc_description', StringType(), True)
2024-03-29 15:08:44,026 Validate     INFO     	StructField('drug_name', StringType(), True)
2024-03-29 15:08:44,026 Validate     INFO     	StructField('tx_cnt', IntegerType(), True)
2024-03-29 15:08:44,026 Validate     INFO     	StructField('total_day_supply', IntegerType(), True)
2024-03-29 15:08:44,026 Validate     INFO     	StructField('total_drug_cost', DoubleType(), True)
2024-03-29 15:08:44,026 Validate     INFO     	StructField('years_of_exp', IntegerType(), True)
2024-03-29 15:08:44,027 Validate     INFO     	StructField('country_name', StringType(), False)
2024-03-29 15:08:44,027 Validate     INFO     	StructField('fullName', StringType(), False)
2024-03-29 15:08:44,027 Validate     INFO     print_schema done, going forward ..
2024-03-29 15:08:44,027 Validate     WARNING  checking null values in all columns ..
2024-03-29 15:08:44,161 Validate     INFO     check_for_nulls done, going forward ..
2024-03-29 15:08:44,161 Driver       ERROR    An error occurred when calling main() please check trace..display_df() missing 1 required positional argument: 'dfname'
Traceback (most recent call last):
  File "/Users/paresh.jadhav/PycharmProjects/SparkProject/driver.py", line 76, in main
    display_df(check_df)
TypeError: display_df() missing 1 required positional argument: 'dfname'
2024-03-29 15:09:17,849 Driver       INFO     Spark session started....<pyspark.sql.session.SparkSession object at 0x7ff0f861d0b8>
2024-03-29 15:09:17,849 Driver       INFO     validating spark object
2024-03-29 15:09:17,849 Validate     INFO     Started the get_current_date function....
2024-03-29 15:09:22,000 Validate     WARNING  Validating spark object with current date [Row(current_date()=datetime.date(2024, 3, 29))] 
2024-03-29 15:09:22,000 Validate     INFO     Validation done, going forward ..
2024-03-29 15:09:22,000 Driver       INFO     Reading file which is of file format, parquet
2024-03-29 15:09:22,000 ingest       WARNING  load_files function started
2024-03-29 15:09:22,615 ingest       WARNING  dataframe created successfully which is of parquet format
2024-03-29 15:09:22,615 Driver       INFO     displaying Dataframe..
2024-03-29 15:09:25,224 Driver       INFO     Validating number of cities...
2024-03-29 15:09:25,224 ingest       WARNING  here to count the records in the df_city
2024-03-29 15:09:26,012 ingest       WARNING  Number of records present in the df_city are 28338
2024-03-29 15:09:26,012 ingest       WARNING  load_files function started
2024-03-29 15:09:30,449 ingest       WARNING  dataframe created successfully which is of csv format
2024-03-29 15:09:30,449 Driver       INFO     displaying Dataframe df_fact
2024-03-29 15:09:31,005 Driver       INFO     Validating number of records in fact...
2024-03-29 15:09:31,005 ingest       WARNING  here to count the records in the df_fact
2024-03-29 15:09:31,909 ingest       WARNING  Number of records present in the df_fact are 1329328
2024-03-29 15:09:31,909 Driver       INFO     implementing data processing functions..
2024-03-29 15:09:31,909 DataProcessing WARNING  data cleaning function started...
2024-03-29 15:09:31,909 DataProcessing WARNING  working on OLAP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 15:09:31,970 DataProcessing WARNING  working on OLTP dataset and selecting required columns and converting some of columns into upper case...
2024-03-29 15:09:32,012 DataProcessing WARNING  Adding new column to df_presc_sel
2024-03-29 15:09:32,027 DataProcessing WARNING  converting years_of_exp to int and replacing = 
2024-03-29 15:09:32,090 DataProcessing WARNING  concat firstname and lastname..
2024-03-29 15:09:32,118 DataProcessing WARNING  dropping columns presc_fname and presc_lname..
2024-03-29 15:09:32,131 DataProcessing WARNING  dropping null values for the columns ..
2024-03-29 15:09:32,167 DataProcessing WARNING  successfully dropped null values ..
2024-03-29 15:09:32,167 DataProcessing WARNING  replacing the null values of tx_cnt column with avg value..
2024-03-29 15:09:34,822 DataProcessing WARNING  data_clean() function executed, going forward..
2024-03-29 15:09:35,396 Driver       INFO     printing schema for dataframes...
2024-03-29 15:09:35,396 Validate     INFO     Started print_schema function for df_city_sel 
2024-03-29 15:09:35,400 Validate     INFO     	StructField('city', StringType(), True)
2024-03-29 15:09:35,400 Validate     INFO     	StructField('state_id', StringType(), True)
2024-03-29 15:09:35,400 Validate     INFO     	StructField('state_name', StringType(), True)
2024-03-29 15:09:35,400 Validate     INFO     	StructField('county_name', StringType(), True)
2024-03-29 15:09:35,400 Validate     INFO     	StructField('population', IntegerType(), True)
2024-03-29 15:09:35,400 Validate     INFO     	StructField('zips', StringType(), True)
2024-03-29 15:09:35,400 Validate     INFO     print_schema done, going forward ..
2024-03-29 15:09:35,400 Validate     INFO     Started print_schema function for df_presc_sel 
2024-03-29 15:09:35,401 Validate     INFO     	StructField('presc_id', IntegerType(), True)
2024-03-29 15:09:35,401 Validate     INFO     	StructField('presc_city', StringType(), True)
2024-03-29 15:09:35,401 Validate     INFO     	StructField('presc_state', StringType(), True)
2024-03-29 15:09:35,401 Validate     INFO     	StructField('presc_description', StringType(), True)
2024-03-29 15:09:35,401 Validate     INFO     	StructField('drug_name', StringType(), True)
2024-03-29 15:09:35,402 Validate     INFO     	StructField('tx_cnt', IntegerType(), True)
2024-03-29 15:09:35,402 Validate     INFO     	StructField('total_day_supply', IntegerType(), True)
2024-03-29 15:09:35,402 Validate     INFO     	StructField('total_drug_cost', DoubleType(), True)
2024-03-29 15:09:35,402 Validate     INFO     	StructField('years_of_exp', IntegerType(), True)
2024-03-29 15:09:35,402 Validate     INFO     	StructField('country_name', StringType(), False)
2024-03-29 15:09:35,402 Validate     INFO     	StructField('fullName', StringType(), False)
2024-03-29 15:09:35,402 Validate     INFO     print_schema done, going forward ..
2024-03-29 15:09:35,402 Validate     WARNING  checking null values in all columns ..
2024-03-29 15:09:35,563 Validate     INFO     check_for_nulls done, going forward ..
2024-03-29 15:11:46,544 Driver       INFO     data_transformation executing...
2024-03-29 15:11:46,545 DataTransformation WARNING  processing data in data_report1 function...
2024-03-29 15:11:46,548 DataTransformation WARNING  calculating total number of zipcodes in DataFrame[city: string, state_id: string, state_name: string, county_name: string, population: int, zips: string]
2024-03-29 15:11:46,595 DataTransformation WARNING  calculating distinct prescribers and total tx_cnt
2024-03-29 15:11:46,630 DataTransformation WARNING  do not create a report for city if no prescriber are present for that city so lets join df_city and df_presc
2024-03-29 15:11:46,681 DataTransformation WARNING  data_report function successfully executed, going forward..
2024-03-29 15:11:46,681 Driver       INFO     displaying the data_report_df...
2024-03-29 15:11:53,258 Driver       INFO     Application done
